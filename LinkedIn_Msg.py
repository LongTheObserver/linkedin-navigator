import time
from selenium import webdriver
from selenium.webdriver.chrome.service import Service
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.common.by import By
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.support import expected_conditions as EC
from selenium.webdriver.common.action_chains import ActionChains
from selenium.common.exceptions import TimeoutException, NoSuchElementException
import pyautogui
import concurrent.futures


def send_message(client):
    serv = Service(".//chromedriver.exe")
    driver = webdriver.Chrome(service=serv)
    driver.get("https://linkedin.com")
    email = WebDriverWait(driver, 10).until(EC.presence_of_element_located((By.XPATH, "//input[@id='session_key']")))
    email.send_keys("hard code")
    password = WebDriverWait(driver, 10).until(
        EC.presence_of_element_located((By.XPATH, "//input[@id='session_password']")))
    password.send_keys("hard code")
    WebDriverWait(driver, 10).until(
        EC.presence_of_element_located((By.XPATH, "//button[@class='sign-in-form__submit-button']"))).click()
    time.sleep(3)
    driver.get(client)
    name = WebDriverWait(driver, 6).until(EC.presence_of_element_located(
        (By.XPATH, "//h1[@class='text-heading-xlarge inline t-24 v-align-middle break-words']"))).text
    try:
        messenger = WebDriverWait(driver, 6).until(EC.presence_of_element_located((By.XPATH, "//a[@class='message-anywhere-button pvs-profile-actions__action artdeco-button ']")))
        messenger.click()
        subject = WebDriverWait(driver, 6).until(EC.presence_of_element_located((By.XPATH, "//input[@name='subject']")))
        subject.send_keys("Hello " + name + ", may I ask you for some favor?")
        text_box = WebDriverWait(driver, 6).until(EC.presence_of_element_located((By.XPATH, "//div[@role='textbox']")))
        text_box.send_keys("Good day {}, I am Louis from Feeniks Team. I am new to Shopify, and my team has just created an application on Shopify App store. I read some articles on Shopify which told me that most of Shopify employees had their own Shopify store businesses, and it would be a good idea to have them as the first to try and give feedbacks to the application. I am very happy to find you on LinkedIn, and I really hope you can spend some times trying our application and give us some of your golden feedbacks. I hope you will be comfortable with that. And I will do my best to keep you happy and comfortable. Thank you very much for your kind consideration.".format(name))
        time.sleep(2)
        send = WebDriverWait(driver, 6).until(EC.presence_of_element_located((By.XPATH, "//div //button[@type='submit']")))
        send.click()
        time.sleep(3)
        driver.close()
    except TimeoutException:
        driver.close()
        print("Fail to send message to " + name)


with concurrent.futures.ThreadPoolExecutor(max_workers=3) as executor:
    urls = ['https://www.linkedin.com/in/hayley-taylor-07a4a1128?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAB9lYR4BLej9rktXLsLF37Fw8UZUIgcTPLQ', 'https://www.linkedin.com/in/melvanlieshout?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAAW4xqQBUccd0j20eodUkScCldYRAXG_CKg', 'https://www.linkedin.com/in/lara-rosqu%C3%ABt-falque-pierrotin-9b868645?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAAmIThwBqn2VCwqpJl1EmLofuMy8VpRiCTw', 'https://www.linkedin.com/in/kraymitchell?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAAAh9DwB05Xp28AT1S4iKxPeSNoipiW8MUc', 'https://www.linkedin.com/in/frankietyng?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAAQPNzABm-jk7DEy0BWyUPWNZRLly3oUtYM', 'https://www.linkedin.com/in/ryota-toyoda-b45127138?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAACF6Y6UB39kpcAcof9tJBTMLzeL33UmEPRg', 'https://www.linkedin.com/in/brontehogarth?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAA84QZEBXHl3dPzrtV5NNoKVGjYqH65MXws', 'https://www.linkedin.com/in/jcmcginnis?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAAKWlE8B9Bin_gwzcyjzDxuRHgvFNxRT2Vk', 'https://www.linkedin.com/in/vanessamcmullen?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAABVqrAoBpz7QhNc9hbDYffQjLB9v7dUhHZA', 'https://www.linkedin.com/in/wiho11?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAA-SEbEB59KFnoFFac3yb1wG3SZ1d-nef94', 'https://www.linkedin.com/in/zoltok?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAABJi7YBt-0hAC6-BDTr8-tq0SZKUUeZKKc', 'https://www.linkedin.com/in/aditiadu?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAAF3eiMBpNdvxPO9AzXx1qY4ZNKzHLVu0q0', 'https://www.linkedin.com/in/saadk7?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAAle6kUBI17pd7riSavMUQXmIuvxjNbgThY', 'https://www.linkedin.com/in/paul-s-cochrane?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAApRUXsBwjUFw5rE41jqaArdUy-pRbwv3sA', 'https://www.linkedin.com/in/danielsilva?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAAB6dnUB2GUlVexFV6_HFtCFkcgK8pMZbJ8', 'https://www.linkedin.com/in/romanzenner?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAADJFuwBcBMCK89GH3R1EGSRnr_7ZEHh5UM', 'https://www.linkedin.com/in/dakotamonk?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAA6qlMkBoOJGOntOvjRy6W9GCSZUsq6vzvQ', 'https://www.linkedin.com/in/jonathan-h-kim-a5109988?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAABKFm50BsWvv_ZG11YccJAqRyyQYJI0QGwE', 'https://www.linkedin.com/in/stephanie-ko-8690609a?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAABUCStEBI1ZR4yIGZbwOyBRufRK4Y8nFpBI', 'https://www.linkedin.com/in/yeemun-tsang?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAAOP13QBoVnwJafIuSYN5ezpbzNEqok3Jnk', 'https://www.linkedin.com/in/daneeg?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAAUtC1gBHZwwyOYKYmFKmruQe2LcbdNSa4s', 'https://www.linkedin.com/in/amy-nicola?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAAMBWLsBEByPu7pNqrYmi4eCSvqOpco5G2U', 'https://www.linkedin.com/in/briangpeters?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAAbVQyYBInDqw_sYRNz4PQ-SANQUVWEDnHg', 'https://www.linkedin.com/in/namranillove?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAAMAru8BUH_EC18mr0f0sukE1HqeTf6V5OU', 'https://www.linkedin.com/in/phyllis-l-94aa7a53?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAAte58oBtSGnafXbTvIz2pDzrlan44QyUeo', 'https://www.linkedin.com/in/andrewmrobbins?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAAXAI9wBZ1G98NC2780g-FZ4SLsmkMpeIys', 'https://www.linkedin.com/in/jeffrey-haga-223805b5?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAABiAkvsBEjItujBFeJI-grneHR6pwWh0Qqs', 'https://www.linkedin.com/in/stefancautin?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAABsF8EIB8PbPhF3XqL_Hz81M2H66ri-cXiw', 'https://www.linkedin.com/in/ayakamikawa?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAABVaTABISTGl1vuvi0u7Sr7MFAJGzuvX2E', 'https://www.linkedin.com/in/lisa-lapp?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAA4CVtcBU7gBLqxpa17TYNF0HNx3p_w7TUk', 'https://www.linkedin.com/in/nicole-sandford?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAAxgw3gBiN6XIVS64XHy412A6psUPoHtsgU', 'https://www.linkedin.com/in/olawaleoshinowo?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAATSh8UBiBucaZGAp42Re2GT6tdZlKI94dI', 'https://www.linkedin.com/in/hagen-meischner-b691a6?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAAAHJQEBLbMGkjjLflGqkLFEUPW8W27ZEtk', 'https://www.linkedin.com/in/marco-battaglia?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAAlrt6sB0iVVFePYUiXxEk4VeHXZlyvRers', 'https://www.linkedin.com/in/vargabbakshi?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAAPnyYcB1hD1ZdBUNJUGWRg7e2YRf4qGesI', 'https://www.linkedin.com/in/elias-savvakis?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAABjd7VsB4mS2nnag4O1isi8OWmofG5bIgpk', 'https://www.linkedin.com/in/juliemajorg?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAAUmPVYBymeR0_vUgAEWHjLvp7cbJvBl_AI', 'https://www.linkedin.com/in/kyleighwagar?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAAsvwH0Bza2MLYRlLF5iihBUjzSOU5P2Xss', 'https://www.linkedin.com/in/%F0%9F%A5%91-shayne-parmelee-492302114?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAByFdC4BljhJiVWYn-ipveicmGbktezViNc', 'https://www.linkedin.com/in/chris-langer-59a85753?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAAtWl4YBx2wSwrdy1zWsBLzfM0wdTAmw-nU', 'https://www.linkedin.com/in/shimonamehta?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAAI3k7gBSp2eFKmTs0AUPkMzh5eDTICw95o', 'https://www.linkedin.com/in/marcosulima?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAATBXcoB7Juf_Q5cSQ-NgwV22MO4MAZH3fY', 'https://www.linkedin.com/in/dav1dshaw?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAAKStRUBTiQApm3lKjxqaBnBd5MSQ4U6d5A', 'https://www.linkedin.com/in/matthiaskleven?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAAfc6TgBUas2R0EDcdsHKnj8HogqcPLz3Vo', 'https://www.linkedin.com/in/junichiokamura?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAAQ-gvgBtVKvl__cLLHPz_O_KYv0nq0A56Q', 'https://www.linkedin.com/in/julian-bartram-shopify-local?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAAKe6MUBT8Eo_UHfgzuKofH2Ry5giG6u0CE', 'https://www.linkedin.com/in/andrea-mattiacci-92a874138?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAACGWdzIBWAp05cl6GkuPf5b2gYepwDJYmiY', 'https://www.linkedin.com/in/varunmtl?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAABlvcSUBlQzeEVGp83Hrb15nAJWLvn3XMj8', 'https://www.linkedin.com/in/ariella-kaplan-a818828?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAAGNe4EBjb84_RMZu5G60ZlZoujEqCazoZs', 'https://www.linkedin.com/in/eaalbers?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAAFHAIkBZldsTIT3BAliBnk14wDxIVkiAtM', 'https://www.linkedin.com/in/joshagnew-shopify?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAAS7ih8BYiaP_vDfMzy6Np8kGQtp8WD5IZ0', 'https://www.linkedin.com/in/andrewcgilliland?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAABzxB6oB6p9S7IU9Szy7PQt1r8uEBSUG-VA', 'https://www.linkedin.com/in/talia-richardson-6a336076?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAABAR7dsBW0gRZTlVQcInhQ9WC1rGlOH6bO8', 'https://www.linkedin.com/in/alani-rodriguez-13872b194?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAC2rgPwB_dXjjIO0Qt3rhKnx24yf6pn3rZ0', 'https://www.linkedin.com/in/hain-joubert-062b2a48?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAAoiKcoBe6EjJ5wcMFhEqwiajgYs04jk4vg', 'https://www.linkedin.com/in/mardy-martin-580829152?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAACTJIfABsx55Cq2SipQAvax8WTdS3Ppxf7A', 'https://www.linkedin.com/in/jonathan-sinclair-44b9aa33?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAAcWi_sBvcycskKp6PMnVJk-cExaaKX7-JM', 'https://www.linkedin.com/in/jonathan-sedlak?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAAEEPvUBFugYVYRig449a8SO5PEfEsmYUlM', 'https://www.linkedin.com/in/joachimantonsen?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAAXuyE0BF9HyI9U-iona2DRz95EKuIwitP4', 'https://www.linkedin.com/in/josh-wrightson-9b41a5194?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAC2XHVgBCHu34T56Dg7C38zZmt4-ASQt9lQ', 'https://www.linkedin.com/in/louisphilippesavard?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAAryz-YBDxfaOndRYrXm5yibzpKT_aDN1SA', 'https://www.linkedin.com/in/mhbergen?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAAAcVXEBixOlVcDt9antu0RlOhQQt3olzys', 'https://www.linkedin.com/in/lasseenggaard?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAABg0_XYBIZ68tPpN4_VbBPuLKpaapAIFuVs', 'https://www.linkedin.com/in/kylemalikfoster?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAAyiQdoB2-wcWmcHa-1EdHSYLgPWt7sxZh0', 'https://www.linkedin.com/in/shelby-skinner-90443810a?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAABt4_hQB15VlSWGjzDXNn597ywzFE_qzjqU', 'https://www.linkedin.com/in/sam-ward-76855a89?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAABLE6MABng-Q5ir-bx6EY-25dvA-p8d4myA', 'https://www.linkedin.com/in/imfarhanshah?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAABLLm-4B53tNT-kweTCTj4YBXnpuLbpqz8A', 'https://www.linkedin.com/in/bengreenfilms?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAABoWlp0BhIPAkkC1mB1MGqgwAG-W458T7xM', 'https://www.linkedin.com/in/ridvant?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAABJtuh8BhJg14EC-hRt3ZEyAEBgDoetoCkM', 'https://www.linkedin.com/in/tamaramasson-shopifyexpert?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAACgt_uEBb1_dExj_l_IYO1nZKg0hYiBy_8w', 'https://www.linkedin.com/in/matt-sharpe-2b080155?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAAuv-GQBiismMmAqk5oWiS9O8e9CrvITzeo', 'https://www.linkedin.com/in/jan-ducreay?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAACdQGWoBUYZlH2W780EEFopPQBd-tSh5Quw', 'https://www.linkedin.com/in/rowby-goren?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAAAgnWEBweRBvx7LRN7V2hf9gdwc3kIdyQU', 'https://www.linkedin.com/in/andrew-knechtel-433461161?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAACawLycBq413679R_wYaBp3QIkbw60htrzs', 'https://www.linkedin.com/in/patrick-walker-96450493?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAABPUjFwBg85VTNI5NeczvZLGBFIK8i5TyfE', 'https://www.linkedin.com/in/anthony-murphy-757104161?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAACai-zMB3vFb-cucIJBYOxysYLcEOVFA0qY', 'https://www.linkedin.com/in/donatas-lomsargis?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAAKLIkcBjWCpTaeS5cj6_4TqQA_pxyJhcQA']
    results = [executor.submit(send_message, site) for site in urls]
